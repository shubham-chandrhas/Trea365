<!-- 
      Note: In complete due to short time period
 -->



<div class="externalWorkOrderWrap">
    <div class="pageTitle"><span *ngIf="!isEdit">New</span> <span *ngIf="isEdit">Edit</span> Work Order</div>

    <form autocomplete="off" role="form" [formGroup]="woForm">
        <div class="infoWrap">
            <div class="row">
                <div class="col-sm-6">
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Date</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col">{{util.getFormatedDate(today)}}</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Generated By</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col">{{generatedBy}}</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Quotation</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col">{{selectedQuotation.project_estimate_no}}</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Assigned to</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col">Staff</div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Client</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col">{{selectedQuotation.client}}</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-5">
                            <div class="label-col">Work Location</div>
                        </div>
                        <div class="col-sm-7">
                            <div class="info-col" *ngIf="selectedQuotation.client_work_location">{{selectedQuotation.client_work_location.address_line_1}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="scheduleDetails">
          <div class="serPart">
            <span>Schedule Recurring</span>
          </div>
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>Start Date</th>
                  <th>Start Time</th>
                  <th>End Date</th>
                  <th>End Time</th>
                  <!-- <th>Repeat</th>
                  <th>Repeat Every</th>
                  <th>Repeat On</th> -->
                </tr>
              </thead>
              <tbody *ngIf="selectedQuotation.schedules">
                <tr >
                  <td>{{util.getFormatedDate(selectedQuotation.schedules.start_date)}}</td>
                  <td>{{selectedQuotation.schedules.start_time.substring(0,5)}} {{selectedQuotation.schedules.start_time_format}}</td>
                  <td>{{util.getFormatedDate(selectedQuotation.schedules.end_date)}}</td>
                  <td>{{selectedQuotation.schedules.end_time.substring(0,5)}} {{selectedQuotation.schedules.end_time_format}}</td>
                  <!-- <td>{{selectedQuotation.schedules.schedule_repeat_details.status}}</td>
                  <td>{{selectedQuotation.schedules.schedule_days && selectedQuotation.schedules.schedule_type == 2 ? selectedQuotation.schedules.schedule_days : 'N/A'}}</td>
                  <td>{{selectedQuotation.schedules.schedule_repeat_details ? selectedQuotation.schedules.schedule_repeat_details.status : 'N/A'}}</td> -->
                </tr>
              </tbody>
            </table>
          </div>
		    </div>

		<!-- {{selectedQuotation.schedules | json}} -->

		

        <div class="workOrderDetails">
            <div class="pageTitle">Recurring Work Order Details</div>
            <div *ngFor="let indx = index; let wo of tempWO">
              <div class="serPart">
                <span>Work order #{{indx+1}} &nbsp;&nbsp;<span style="font-size: 14px;font-weight: 500;">( Start : {{wo.start_date}} {{wo.start_time}} {{wo.start_time_format}} &nbsp;-&nbsp;  End : {{wo.end_date}} {{wo.end_time}} {{wo.end_time_format}} )</span></span>
              </div>

              <!-- <div class="table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Start Date</th>
                      <th>Start Time</th>
                      <th>End Date</th>
                      <th>End Time</th>
                    </tr>
                  </thead>
                  <tbody *ngIf="selectedQuotation.schedules">
                    <tr >
                      <td>{{selectedQuotation.schedules.start_date | date: 'dd/MM/yyyy'}}</td>
                      <td>{{selectedQuotation.schedules.start_time.substring(0,5)}} {{selectedQuotation.schedules.start_time_format}}</td>
                      <td>{{selectedQuotation.schedules.end_date | date: 'dd/MM/yyyy'}}</td>
                      <td>{{selectedQuotation.schedules.end_time.substring(0,5)}} {{selectedQuotation.schedules.end_time_format}}</td>
                    </tr>
                  </tbody>
                </table>
              </div> -->

            <!-- </div> -->

            <div class="button-row">
              <button class="trea-btn" [ngClass]="wo.tab == 'services' ? 'act-option' :''" (click)="WOService.currentClick = 'services';changeQuotTab(wo, 'services');" mat-raised-button >Services</button>
              <button [ngClass]="wo.tab == 'team' ? 'act-option' :''" (click)="WOService.currentClick = 'team';changeQuotTab(wo, 'team');" mat-raised-button class="trea-btn">Team</button>
              <button [ngClass]="wo.tab == 'assets' ? 'act-option' :''" (click)="WOService.currentClick = 'assets';changeQuotTab(wo, 'assets');" mat-raised-button class="trea-btn">Assets</button>
              <button [ngClass]="wo.tab == 'products' ? 'act-option' :''" (click)="WOService.currentClick = 'products';changeQuotTab(wo, 'products');" mat-raised-button class="trea-btn">Products/Materials</button>
            </div>
            <div class="clearfix"></div>

            <div class="servicesWrap MB30" >
              <section *ngIf="wo.tab == 'services'">
                <div class="table-responsive">
              <table class="table">
                  <thead>
                      <tr>
                          <th class="closeIcon" style="width: 32px;"></th>
                          <th style="width: 235px;">Type</th>
                          <th>Cost</th>
                          <th>Quantity</th>
                          <th>Amount</th>
                          <th>Details</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr *ngFor="let service of woSetupData.services; let indx=index">
                          <td class="closeIcon"></td>
                          <td>
                              {{service.service}}
                          </td>
                          <td>
                              {{service.cost | currency: util.getCurrency() :'symbol-narrow'}}
                          </td>
                          <td>
                              {{service.WO_quantity}}
                          </td>
                          <td>
                              {{service.total_amount | currency: util.getCurrency() :'symbol-narrow'}}
                          </td>
                          <td>
                              {{service.details}}
                          </td>
                      </tr>
                      <!-- <tr>
                          <td colspan="3" class="tAmtTxt"> Total Amount </td>
                          <td colspan="3" class="tAmtVal"> 30,000
                            {{oldWODetails.totalAmt | currency: util.getCurrency() :'symbol-narrow'}}
                          </td>
                      </tr> -->
                  </tbody>
              </table>
              <div class="label-col text-center MB20"></div>
          </div>
              </section>

              <section *ngIf="wo.tab == 'team'">
                <app-team [team]="wo.team"></app-team>
              </section>
              
              <section *ngIf="wo.tab == 'assets'">
                <!-- <app-assets [asset]="wo.asset"></app-assets> -->
              </section>
              
              <section *ngIf="wo.tab == 'products'">
                <app-products></app-products>
              </section>

                <!-- <router-outlet></router-outlet> -->
            </div>

        </div>
        <div class="clearfix"></div>

        <div class="signatureChkBox">
            <div class="checkBox">
                <label>
                    <input autocomplete="nope" name="require_client_sign" type="checkbox" formControlName="require_client_sign">
                    <span class="iconChk"><i class="fa fa-check"></i> </span>
                    Require client's signature upon completion
                </label>
            </div>
        </div>

        <div class="errMsgCon" *ngIf="isError">
            <small>{{errMsg}}</small>
        </div>

        <div class="button-row text-center">
            <button *ngIf="currentAction == 'EDIT'" id="update-btn" mat-raised-button class="trea-btn" (click)="save()">Update</button>
            <button *ngIf="currentAction == 'ADD'" id="save-btn" mat-raised-button class="trea-btn" (click)="save()">Next</button>
            <button mat-raised-button class="trea-btn" routerLink="/workflow/wo/csa/work-order-list/0">Cancel</button>
        </div>
      </div>
    </form>
    <!-- <pre>
        <code>{{woForm.value | json}}</code>
    </pre> -->
</div>