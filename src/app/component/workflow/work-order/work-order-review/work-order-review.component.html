<div class="generateQuoteWrap">
    <div class="pageTitle">New Work Order Information Review</div>
    <div class="container-fluid">
        <div class="selSection">
            <div class="clearfix"></div>
            <div class="newWorkOrderDetails">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="label-col">Date</div>
                            </div>
                            <div class="col-sm-6">
                                <div class="info-col">{{util.getFormatedDate(today)}}</div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="col-sm-6">
                                <div class="label-col">Generated by</div>
                            </div>
                            <div class="col-sm-6">
                                <div class="info-col">{{userInfo.first_name}}</div>
                            </div>
                            <div class="clearfix"></div>
                            <!-- <div class="col-sm-6">
                                <div class="label-col">Quotation</div>
                            </div>
                            <div class="col-sm-6">
                                <div class="info-col"></div>
                            </div> -->
                            <div class="clearfix"></div>
                            <div class="col-sm-6">
                                <div class="label-col">Assigned to</div>
                            </div>
                            <div class="col-sm-6">
                                <div class="info-col">Staff</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="row">
                            <div *ngIf="woType == 'external'" class="col-sm-6">
                                <div class="label-col">Client</div>
                            </div>
                            <div *ngIf="woType == 'external'" class="col-sm-6">
                                <div class="info-col">{{pageData.work_location.client_details.company_name ? pageData.work_location.client_details.company_name : pageData.work_location.client_details.first_name +" "+ pageData.work_location.client_details.last_name }}</div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="col-sm-6">
                                <div class="label-col">Work Location</div>
                            </div>
                            <div class="col-sm-6">
                                <div class="info-col">
                                    <div *ngIf="woType == 'internal' && pageData.repairInfo; else manuallyAddedWorkLocation">
                                        {{pageData.repairInfo.defaultLocation}}
                                    </div>
                                    <!-- {{ woType == 'internal' ? pageData.repairInfo ? pageData.repairInfo.location : '' : (pageData.work_location.client_work_location.address_line_1+" "+pageData.work_location.client_work_location.address_line_2 +" "+ pageData.work_location.client_work_location.city_details.city_name +" "+ pageData.work_location.client_work_location.province_details.province_name +" "+ pageData.work_location.client_work_location.country_details.country_name )}} -->

                                    <ng-template #manuallyAddedWorkLocation>
                                        <!-- <div *ngIf="woType == 'external'; else location">
                                            <div *ngIf="pageData.work_location.client_work_location.latitude && pageData.work_location.client_work_location.latitude && pageData.work_location.client_work_location.latitude != '0' && pageData.work_location.client_work_location.longitude && pageData.work_location.client_work_location.longitude != '0';else location">
                                                {{pageData.work_location.client_work_location.address_line_1}}
                                            </div>
                                        </div> -->

                                        <div *ngIf="woType == 'external'">

                                                {{pageData.work_location && pageData.work_location.client_work_location && pageData.work_location.client_work_location.address_line_2 ? pageData.work_location.client_work_location.address_line_2+', ' : ''}}{{pageData.work_location.client_work_location.address_line_1}}

                                        </div>

                                        <!-- <ng-template #location>
                                            {{pageData.work_location.client_work_location.address_line_1 ? pageData.work_location.client_work_location.address_line_1 + ',' : '' }} {{pageData.work_location.client_work_location.address_line_2 ? pageData.work_location.client_work_location.address_line_2 + ',' : '' }}
                                            {{pageData.work_location.client_work_location.city_details.city_name ? pageData.work_location.client_work_location.city_details.city_name + ',' : '' }}
                                            {{pageData.work_location.client_work_location.province_details.province_name ? pageData.work_location.client_work_location.province_details.province_name + ',' : '' }}
                                            {{pageData.work_location.client_work_location.country_details.country_name ? pageData.work_location.client_work_location.country_details.country_name + ',' : '' }}
                                            {{pageData.work_location.client_work_location.postal_code}}
                                        </ng-template>     -->
                                    </ng-template>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="workOrderReviewWrap clearfix">
                <div class="row">
                    <div class="col-sm-12">
                        <p class="titletxt">Schedule</p>
                        <div class="table-responsive workServiceTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th>Start Date</th>
                                    <th>Start Time</th>
                                    <th>End Date</th>
                                    <th>End Time</th>
                                    <!-- <th>Repeat</th>
                                    <th>Repeat Every</th>
                                    <th>Repeat On</th> -->
                                </tr>
                                <tr>
                                    <td>{{util.getFormatedDate(util.stringToDate(pageData.scheduleDetails.start_date))}}</td>
                                    <td>{{pageData.scheduleDetails.start_time}} {{pageData.scheduleDetails.start_time_format}}</td>
                                    <td>{{util.getFormatedDate(util.stringToDate(pageData.scheduleDetails.end_date))}}</td>
                                    <td>{{pageData.scheduleDetails.end_time}} {{pageData.scheduleDetails.end_time_format}}</td>
                                    <!-- <td>{{pageData.scheduleDetails.schedule_type == 2 ? pageData.scheduleDetails.schedule_type_name : 'N/A'}}</td>
                                    <td>{{pageData.scheduleDetails.schedule_type == 2 ? pageData.scheduleDetails.schedule_repeat_name : 'N/A'}}</td>
                                    <td>{{pageData.scheduleDetails.schedule_type == 2 ? repeatOn : 'N/A'}}</td> -->
                                    <!-- <td>N/A</td> -->
                                    <!-- <td>{{pageData.scheduleDetails.schedule_days.Mon ? 'Mon' : pageData.scheduleDetails.schedule_days.Tue ? ', Tue' : pageData.scheduleDetails.schedule_days.Wed ? ', Wed' : pageData.scheduleDetails.schedule_days.Thu ? ', Thu' : pageData.scheduleDetails.schedule_days.Fri ? ', Fri' : pageData.scheduleDetails.schedule_days.Sat ? ', Sat' : pageData.scheduleDetails.schedule_days.Sun ? ', Sun' : 'N/A'}}</td> -->
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <p class="titletxt">Services</p>
                        <div class="table-responsive workServiceTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th width="300">Service Type</th>
                                    <th width="300">Quantity</th>
                                    <th width="300">Details</th>
                                </tr>
                                <tr *ngFor="let item of pageData.servicesDetails.services">
                                    <td>{{item.service_definition}}</td>
                                    <td>{{item.quantity | number:"1.2-2"}}</td>
                                    <td>{{item.details}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <p class="titletxt">Assets</p>
                        <div class="table-responsive workServiceTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th>Name</th>
                                    <th>Start Date</th>
                                    <th>Start Time</th>
                                    <th>End Date</th>
                                    <th>End Time</th>
                                </tr>
                                <tr *ngFor="let item of pageData.assetsDetails">
                                    <td>{{item.asset}}</td>
                                    <td>{{util.getFormatedDate(util.stringToDate(item.start_date))}}</td>
                                    <td>{{item.start_time}} {{item.start_time_format}}</td>
                                    <td>{{util.getFormatedDate(util.stringToDate(item.end_date))}}</td>
                                    <td>{{item.end_time}} {{item.end_time_format}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <p class="titletxt">Team</p>
                        <div class="table-responsive workServiceTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th>Name</th>
                                    <th>Start Date</th>
                                    <th>Start Time</th>
                                    <th>End Date</th>
                                    <th>End Time</th>
                                </tr>
                                <tr *ngFor="let item of pageData.teamDetails">
                                    <td>{{item.staff}} <span *ngIf="item.is_team_leader == 1" style="font-size: 10px;">(Team leader)</span> </td>
                                    <td>{{util.getFormatedDate(util.stringToDate(item.start_date))}}</td>
                                    <td>{{item.start_time}} {{item.start_time_format}}</td>
                                    <td>{{util.getFormatedDate(util.stringToDate(item.end_date))}}</td>
                                    <td>{{item.end_time}} {{item.end_time_format}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12">
                        <p class="titletxt">Materials</p>
                        <div class="table-responsive workMaterialTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th width="300">Type</th>
                                    <th width="300">Cost</th>
                                    <th width="300">Quantity(Units)</th>
                                    <th width="300">Location</th>
                                </tr>
                                <tr *ngFor="let item of pageData.materialsDetails">
                                    <td>{{item.material_name}}</td>
                                    <td>{{item.cost | currency: util.getCurrency() :'symbol-narrow'}}</td>
                                    <td>{{item.quantity}} {{item.uom ? item.uom : ''}}</td>
                                    <td>
                                        <!-- <div class="info-col" *ngIf="item.locationType == '1'">
                                            <div>Supplier : {{item.supplierName}}</div>
                                        </div>
                                        <div class="info-col" *ngIf="item.locationType == '2'">
                                            <div>Work</div>
                                        </div> -->
                                        <div class="info-col" *ngIf="item.locationType == '3'">
                                            <!-- <div>Internal</div> -->
                                            <!-- <div *ngFor="let locInd = index; let loc of item.prodMatLocation1">
                                                <div><span class="locNum">{{locInd + 1}}.</span> {{loc.mainLocation}}</div>
                                                <div><span class="locNum">&nbsp;&nbsp;</span>&nbsp;{{loc.subLocation}}</div>
                                                <div><span class="locNum">&nbsp;&nbsp;</span>&nbsp;Pick up quantity - {{loc.pickupQuantity}} {{item.uom}}</div>
                                            </div> -->

                                            <li *ngFor="let locInd = index; let loc of item.prodMatLocation1">
                                                <div style="margin: -20px 0px 10px 0px;">
                                                    <div><span class="locNum">&nbsp;&nbsp;</span>&nbsp;{{loc.mainLocation}}</div>
                                                    <div><span class="locNum">&nbsp;&nbsp;</span>&nbsp;{{loc.subLocation}}</div>
                                                    <div><span class="locNum">&nbsp;&nbsp;</span>&nbsp;Pick up quantity - {{loc.pickupQuantity}} {{item.uom}}</div>
                                                </div>
                                            </li>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- <div class="row" *ngIf="isExternalWO">
                    <div class="col-sm-6">
                        <p class="titletxt">Payment Schedule</p>
                        <div class="table-responsive workMaterialTbl">
                            <table class="table rewiewTbl">
                                <tr>
                                    <th width="300">Payment Date</th>
                                    <th width="300">Amount Due</th>
                                </tr>
                                <tr *ngFor="let item of pageData.paymentSchedules">
                                    <td>{{item.date}}</td>
                                    <td>{{item.amount_due | currency: util.getCurrency() :'symbol-narrow'}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>   -->

                <div class="row">
                    <div class="col-sm-12">
                        <div class="errMsgCon MT20" *ngIf="isError">
                            <small>{{errMsg}}</small>
                        </div>
                        <div class="button-row clearfix">
                            <button
                                class="trea-btn" mat-raised-button id="previewBtn" (click)="previewDoc()">
                                Preview
                            </button>
                            <button class="trea-btn " mat-raised-button  id="downloadPDF" (click)="downloadPDF()">
                                Download as PDF
                            </button>
                        </div> 
                        <div class="button-row clearfix">
                            <button mat-raised-button class="trea-btn" (click)="edit()">Edit</button>
                            <!-- <button mat-raised-button *ngIf="!isExternalWO" class="trea-btn" (click)="edit('internal')">Edit</button>
                            <button mat-raised-button *ngIf="isExternalWO" class="trea-btn" (click)="edit('external')">Edit</button> -->
                            <!-- <button mat-raised-button class="trea-btn">Save</button> -->
                            
                            <button mat-raised-button class="trea-btn" id="submit" (click)="submit()">Submit</button>
                            <button mat-raised-button routerLink="/workflow/wo/csa/work-order-list/0" class="trea-btn">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
